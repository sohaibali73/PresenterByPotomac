---
name: jspptxpotomac
description: "Potomac brand PowerPoint generation skill using pptxgenjs. API-ready: accepts a JSON outline and returns a brand-compliant PPTX as base64. Covers all 13 slide layouts with full JS generator code. Zero-tolerance brand enforcement."
license: Proprietary
---

# JSPPTXPotomac — Potomac Presentation Generator (pptxgenjs)

**Read this entire file before writing any code. Always use pptxgenjs — never Python.**

> **⚠️ CLAUDE API MODE:** When called via the Claude Developer API (Messages endpoint), Claude has no code execution capability. Claude must return a complete, self-contained Node.js script. The calling server runs it with `node script.js`. See Section 2.

---

## Table of Contents
1. [How This Skill Works](#how-this-skill-works)
2. [API Workflow](#api-workflow)
3. [Outline Schema](#outline-schema)
4. [Brand Specifications](#brand-specifications)
5. [Slide Layout Catalog](#slide-layout-catalog) — 13 layouts
6. [Asset Paths](#asset-paths)
7. [Complete Generator Code](#complete-generator-code)
8. [QA Requirements](#qa-requirements)

---

## 1. How This Skill Works

### Two Usage Modes

**Mode A — Interactive (Claude in claude.ai with computer use)**
User asks Claude to make a presentation → Claude reads this skill → runs Node.js code directly → delivers PPTX file.

**Mode B — API-Driven (Claude Developer API / Messages endpoint)**
The standard Claude API has no code execution. Claude returns a **complete, self-contained Node.js script** as text. Your server runs it.

Correct API workflow:
1. App sends POST to Claude API with this skill as system prompt
2. User provides JSON or plain-text outline
3. Claude returns a complete Node.js script in a `javascript` code block
4. **Your server** runs: `node temp_script.js`
5. Script writes the PPTX, prints JSON to stdout: `{"pptx_base64": "...", "slide_count": N, "filename": "..."}`
6. App decodes base64, serves download

**Core principle:** Build all slides using pptxgenjs primitives (`addText`, `addShape`, `addImage`, `addTable`). Match the visual design of the Potomac master template exactly — colors, fonts, layout positions — but generate from scratch in JS. No Python. No template file dependency.

---

## 2. API Workflow

### What Claude Returns (API Mode)

Claude's response should be a complete Node.js script:

````
Here is the Node.js script to generate your Potomac presentation. Run with: `node generate.js`

```javascript
#!/usr/bin/env node
// Potomac Presentation Generator — auto-generated by Claude (JSPPTXPotomac skill)
// Run: node generate.js
// Requires: npm install pptxgenjs

const pptxgen = require('pptxgenjs');
const fs = require('fs');
const path = require('path');

// ── CONFIGURE ─────────────────────────────────────────────────────────────────
const OUTPUT_PATH = 'Potomac_Presentation.pptx';   // <-- UPDATE IF NEEDED
const LOGO_PATH   = path.join(__dirname, 'brand-assets/logos/potomac-full-logo.png');
// ─────────────────────────────────────────────────────────────────────────────

const OUTLINE = {
  // ... Claude embeds full outline here
};

// [All generator code from Section 7 pasted inline]

main();
```
````

### System Prompt for Your Application

```
You are a Potomac presentation generator using the JSPPTXPotomac skill.
When given a presentation outline:
1. Parse and map each slide to the correct Potomac layout
2. Return a COMPLETE, self-contained Node.js script using pptxgenjs
3. Embed the full outline as a JS object named OUTLINE
4. Include OUTPUT_PATH and LOGO_PATH as configurable variables at the top
5. Include ALL generator functions from Section 7 of the skill inline
6. The script must write the PPTX file and print JSON to stdout:
   {"pptx_base64": "...", "slide_count": N, "filename": "..."}
7. Do NOT try to execute the script — only return it as text
8. Never use Python. Always use pptxgenjs.
```

### NextJS Handler

```typescript
// app/api/generate-presentation/route.ts
import Anthropic from '@anthropic-ai/sdk';
import { execSync } from 'child_process';
import fs from 'fs';
import path from 'path';
import os from 'os';

const client = new Anthropic();
const SKILL_CONTENT = fs.readFileSync(
  path.join(process.cwd(), 'skills/JSPPTXPotomac/SKILL.md'),
  'utf-8'
);

export async function POST(request: Request) {
  const { outline } = await request.json();

  // Step 1: Ask Claude to generate the Node.js script
  const response = await client.messages.create({
    model: 'claude-opus-4-6',
    max_tokens: 16000,
    system: `You are a Potomac presentation generator. Use this skill:\n\n${SKILL_CONTENT}\n\nReturn ONLY a complete Node.js script using pptxgenjs. No Python. No explanation needed — just the script.`,
    messages: [{
      role: 'user',
      content: `Generate a Potomac PowerPoint from this outline:\n\n${JSON.stringify(outline, null, 2)}`
    }]
  });

  // Step 2: Extract the script
  const text = response.content[0].type === 'text' ? response.content[0].text : '';
  const scriptMatch = text.match(/```(?:javascript|js)\n([\s\S]*?)\n```/);
  if (!scriptMatch) {
    return Response.json({ error: 'Claude did not return a JS script' }, { status: 500 });
  }

  // Step 3: Write to temp file and run
  const tmpDir = os.tmpdir();
  const scriptPath = path.join(tmpDir, `potomac_${Date.now()}.js`);
  const outputPath = path.join(tmpDir, `potomac_${Date.now()}.pptx`);

  let script = scriptMatch[1];
  // Patch output path and logo path
  script = script.replace(/OUTPUT_PATH\s*=\s*['"][^'"]*['"]/, `OUTPUT_PATH = '${outputPath}'`);
  script = script.replace(/LOGO_PATH\s*=\s*['"][^'"]*['"]/, 
    `LOGO_PATH = '${path.join(process.cwd(), 'skills/JSPPTXPotomac/brand-assets/logos/potomac-full-logo.png')}'`);

  fs.writeFileSync(scriptPath, script);

  try {
    const stdout = execSync(`node ${scriptPath}`, {
      timeout: 60000,
      env: { ...process.env, NODE_PATH: path.join(process.cwd(), 'node_modules') }
    }).toString();

    const result = JSON.parse(stdout.trim());
    const buffer = Buffer.from(result.pptx_base64, 'base64');

    return new Response(buffer, {
      headers: {
        'Content-Type': 'application/vnd.openxmlformats-officedocument.presentationml.presentation',
        'Content-Disposition': `attachment; filename="${result.filename}"`,
      }
    });
  } finally {
    try { fs.unlinkSync(scriptPath); } catch {}
    try { fs.unlinkSync(outputPath); } catch {}
  }
}
```

### Server Requirements
- Node.js 18+
- `npm install pptxgenjs` in the project
- Logo PNGs accessible on the server filesystem
- Works on Vercel (Node.js only — no Python needed!)

---

## 3. Outline Schema

```json
{
  "title": "Presentation Title",
  "strategy_name": "Guardian",
  "slides": [
    { "layout": "cover", "title": "GUARDIAN: BUILT TO CONQUER RISK" },
    { "layout": "section_divider", "section_title": "OUR PROCESS" },
    {
      "layout": "three_pillars",
      "section_tag": "PROCESS",
      "title": "MARKET ANALYSIS: THREE LEGS TO THE STOOL",
      "subtitle": "We analyze three key factors to determine market positioning",
      "pillars": [
        { "label": "TREND", "description": "Price trend analysis across all major asset classes" },
        { "label": "MOMENTUM", "description": "Rate of change across multiple timeframes" },
        { "label": "BREADTH", "description": "Market participation across segments" }
      ]
    },
    {
      "layout": "chart",
      "section_tag": "PERFORMANCE",
      "chart_title": "HISTORICAL PERFORMANCE",
      "chart_caption": "Past performance does not guarantee future results.",
      "chart_image_path": "/optional/path/to/chart.png"
    },
    {
      "layout": "composite_three",
      "section_tag": "PROCESS",
      "headline": "OUR COMPOSITES HIGHLIGHT RISK-ON AND RISK-OFF BEHAVIOR",
      "components": [
        { "title": "TREND COMPOSITE", "body": "Measures direction of primary trend" },
        { "title": "MOMENTUM COMPOSITE", "body": "Measures speed of market moves" },
        { "title": "RESULT", "body": "Actionable risk-on / risk-off signal", "is_result": true }
      ]
    },
    {
      "layout": "composite_four",
      "section_tag": "PROCESS",
      "title": "SYSTEM ARCHITECTURE",
      "subtitle": "Four inputs, one clear signal",
      "components": [
        { "title": "INPUT 1", "body": "Description" },
        { "title": "INPUT 2", "body": "Description" },
        { "title": "INPUT 3", "body": "Description" },
        { "title": "OUTPUT", "body": "Final signal", "is_result": true }
      ],
      "footnote": "Footnote or disclaimer"
    },
    {
      "layout": "five_component_diagram",
      "section_tag": "FRAMEWORK",
      "title": "TACTICAL ALLOCATION FRAMEWORK",
      "subtitle": "GUARDIAN STRATEGY",
      "center_label": "CORE FOCUS",
      "center_body": "Primary objective text",
      "components": [
        { "label": "COMPONENT A", "body": "Description A", "position": "top_left" },
        { "label": "COMPONENT B", "body": "Description B", "position": "top_right" },
        { "label": "COMPONENT C", "body": "Description C", "position": "bottom_left" },
        { "label": "COMPONENT D", "body": "Description D", "position": "bottom_right" }
      ]
    },
    {
      "layout": "strategy_table",
      "strategy_name": "Guardian",
      "title": "A TACTICAL APPROACH TO RISK-ON",
      "table_title": "Guardian Risk-On Opportunities",
      "columns": ["ASSET CLASS", "ALLOCATION"],
      "rows": [
        ["US Large Cap Equity", "40%"],
        ["International Equity", "20%"],
        ["Fixed Income", "25%"],
        ["Alternatives", "15%"]
      ],
      "footnote": "Source: Potomac as of Q4 2024"
    },
    {
      "layout": "risk_statistics",
      "strategy_name": "Guardian",
      "headline": "IF YOU WANT THE S&P 500, JUST BUY THE S&P 500",
      "table_title": "RISK STATISTICS",
      "columns": ["NET"],
      "rows": [
        { "label": "Annualized Return", "values": ["8.4%"] },
        { "label": "Standard Deviation", "values": ["6.2%"] },
        { "label": "Maximum Drawdown", "values": ["-12.3%"] }
      ],
      "disclaimer": "Performance data as of 12/31/2024. Past performance does not guarantee future results."
    },
    {
      "layout": "use_cases",
      "strategy_name": "Guardian",
      "title": "HOW ARE ADVISORS USING GUARDIAN?",
      "cases": [
        { "title": "RISK MANAGEMENT", "body": "Replace or supplement bond allocation" },
        { "title": "INCOME SEEKING", "body": "Generate consistent income with downside protection" },
        { "title": "DIVERSIFICATION", "body": "Reduce correlation to traditional equity exposure" },
        { "title": "VOLATILITY CONTROL", "body": "Smooth returns during market turbulence" }
      ]
    },
    { "layout": "thank_you" },
    { "layout": "disclosures" },
    {
      "layout": "definitions",
      "definitions": [
        { "term": "Beta", "definition": "Measures the relationship between an investment and the S&P 500." },
        { "term": "Drawdown", "definition": "A losing period defined as the percent retrenchment from peak to trough." }
      ]
    }
  ]
}
```

---

## 4. Brand Specifications

### Colors
| Role | Hex | Usage |
|------|-----|-------|
| Yellow | `#FEC00F` | Primary accent, backgrounds, highlights |
| Dark Gray | `#212121` | Dark backgrounds, text on light bg |
| White | `#FFFFFF` | Light backgrounds, text on dark bg |
| Turquoise | `#00DED1` | Funds / Investment Strategies only |
| Pink | `#EB2F5C` | Rare accent only |

**Rules:**
- Text on dark backgrounds → WHITE or YELLOW only
- Text on light/yellow backgrounds → `#212121` only
- Never use generic blue, red, green, purple, or Arial gray

### Typography
| Role | Font | Style | Size |
|------|------|-------|------|
| Slide titles | Rajdhani | Bold, ALL CAPS | 36–44pt |
| Section headers | Rajdhani | Bold, ALL CAPS | 20–28pt |
| Body text | Quicksand | Regular | 14–18pt |
| Captions / footnotes | Quicksand | Light | 10–12pt |
| Funds only | LexendDeca | Regular | 14–16pt |

**In pptxgenjs:** `fontFace: 'Rajdhani'` or `fontFace: 'Quicksand'`

### Slide Dimensions
- Width: 13.33 inches (960px at 72dpi) → pptxgenjs default widescreen
- Height: 7.5 inches
- Use `pres.layout = 'LAYOUT_WIDE'` (pptxgenjs built-in 16:9)

---

## 5. Slide Layout Catalog

### Layout 1: Cover
**Visual:** Yellow `#FEC00F` background. Large dark gray bold title centered. Potomac logo top-left. "Built to Conquer Risk®" tagline bottom. Strategy name in dark gray top-right tag.

**pptxgenjs approach:**
- Background: `{ color: 'FEC00F' }`
- Title: Rajdhani Bold, 44pt, `#212121`, centered, vertically centered in slide
- Logo: top-left image, ~2" wide
- Tagline: Quicksand, 16pt, `#212121`, bottom-center

---

### Layout 2: Section Divider
**Visual:** White background. Large centered title in dark gray Rajdhani ALL CAPS. Yellow horizontal rule below title. Small icon badge top-right.

**pptxgenjs approach:**
- Background: white
- Title: Rajdhani Bold, 40pt, `#212121`, centered, y≈3"
- Yellow rule: `addShape(RECTANGLE)`, `#FEC00F`, thin strip below title
- Icon: top-right image

---

### Layout 3: Five-Component Diagram (Hub & Spoke)
**Visual:** Dark `#212121` background. Section tag + title top-left in white/yellow. Four corner boxes (top-left, top-right, bottom-left, bottom-right) each with a yellow bold label and white body text. Center box with yellow border containing center label and body.

**pptxgenjs approach:**
- Background: `#212121`
- 4 corner text blocks: label in Rajdhani yellow, body in Quicksand white
- Center box: `addShape(RECTANGLE)` with yellow border, no fill, label+body inside
- Connecting lines: `addShape(LINE)` in yellow from each corner to center

---

### Layout 4: Three Pillars
**Visual:** Dark background. Section tag top-left. Large white title. Three numbered circles (1, 2, 3) in a row, each yellow-filled with dark number, below each a bold label and body text in white.

**pptxgenjs approach:**
- Background: `#212121`
- Title: Rajdhani Bold, 32pt, white
- Three circles: `addShape(ELLIPSE)`, fill `#FEC00F`, number inside Rajdhani Bold dark gray
- Label below each: Rajdhani Bold, 16pt, white, ALL CAPS
- Body below each: Quicksand, 14pt, white

---

### Layout 5: Chart
**Visual:** White background. Section tag top-left. Bold chart title. Large image area for chart (if provided) or placeholder box. Caption/disclaimer at bottom in small gray text.

**pptxgenjs approach:**
- Background: white
- Chart title: Rajdhani Bold, 28pt, `#212121`
- Chart image: `addImage()` in center area, or gray placeholder rectangle
- Caption: Quicksand Light, 10pt, gray, bottom

---

### Layout 6: Three-Component Formula (A + B = C)
**Visual:** Dark background. Headline text at top in white. Three boxes in a row connected by `+` and `=` symbols. Each box has a yellow bold title and white body. Result box (C) has a yellow background with dark text.

**pptxgenjs approach:**
- Background: `#212121`
- Headline: Rajdhani Bold, 24pt, white
- 3 boxes: `addShape(RECTANGLE)`, dark fill with yellow border for inputs, yellow fill for result
- `+` and `=`: addText, yellow, large, centered between boxes
- Box titles: Rajdhani Bold, 16pt, yellow (or dark for result box)
- Box bodies: Quicksand, 13pt, white (or dark for result box)

---

### Layout 7: Four-Component Formula
**Visual:** Same as Three-Component but with 4 boxes: 3 inputs in a column on left connected by `+`, arrow pointing right to result box. Dark background.

**pptxgenjs approach:**
- Same color rules as Layout 6
- 3 input boxes stacked vertically, left side
- Arrow shape or `→` text pointing right
- 1 result box on right, yellow background

---

### Layout 8: Strategy Table
**Visual:** White background. Strategy name tag top-left. Bold title. Large table with yellow merged header row, dark gray column header row, and alternating white rows. Footnote at bottom.

**pptxgenjs `addTable()` approach:**
- Row 0: merged, yellow bg `#FEC00F`, dark text, table title
- Row 1: dark gray bg `#212121`, white text, column headers, Rajdhani Bold ALL CAPS
- Data rows: white bg, `#212121` text, Quicksand, alternating light gray `#F5F5F5`
- Footnote: Quicksand Light, 10pt, gray

---

### Layout 9: Risk Statistics
**Visual:** White background. Strategy name tag. Bold headline. Statistics table with labeled rows and value columns. Disclaimer at bottom.

**pptxgenjs `addTable()` approach:**
- Header row: yellow bg, dark text, Rajdhani Bold ALL CAPS
- Label column: white bg, `#212121`, Quicksand
- Value columns: white bg, Rajdhani Bold for numbers
- Disclaimer: Quicksand Light, 10pt, gray

---

### Layout 10: Use Cases
**Visual:** Dark `#212121` background. Strategy name tag. Bold white title. Four large yellow-bordered circles in a row, each with a title and body inside.

**pptxgenjs approach:**
- Background: `#212121`
- Title: Rajdhani Bold, 32pt, white
- 4 circles: `addShape(ELLIPSE)`, line color `#FEC00F`, no fill (or very dark fill)
- Inside each: title in Rajdhani Bold yellow, body in Quicksand white

---

### Layout 11: Thank You / Contact
**Visual:** Dark `#212121` background. "POTOMAC" wordmark top-left. "THANK YOU!" centered bold white. Yellow tagline below. Contact info (URL, phone). QR code area bottom-right.

**pptxgenjs approach:**
- Background: `#212121`
- "THANK YOU!": Rajdhani Bold, 48pt, white, centered
- Tagline: Quicksand, 20pt, `#FEC00F`, centered
- Contact: Quicksand, 14pt, white, centered
- QR code: `addImage()` if path provided, else omit

---

### Layout 12: Disclosures
**Visual:** Dark background. "DISCLOSURES" header. Dense legal text in small Quicksand. Compliance ID bottom-right.

**pptxgenjs approach:**
- Background: `#212121`
- Header: Rajdhani Bold, 22pt, `#FEC00F`, ALL CAPS
- Body: Quicksand, 9pt, white, multiline, full-page text box
- Compliance ID: format `PFM-XXX-YYYYMMDD` — update date to today

Default disclosure text:
```
Potomac is a registered investment adviser. Registration with the SEC does not imply a 
certain level of skill or training. The information presented herein is for informational 
and educational purposes only and is not intended as investment advice. Past performance 
does not guarantee future results. All investing involves risk, including possible loss of 
principal. The strategies described may not be suitable for all investors.

Indices referenced are unmanaged and cannot be invested in directly. The S&P 500 Index is 
a market-capitalization-weighted index of 500 leading publicly traded companies in the U.S.

Please refer to Potomac's Form ADV Part 2A for additional information about our services, 
fees, and risks. A copy is available at www.adviserinfo.sec.gov or by contacting us at 
info@potomac.com.

PFM-508-YYYYMMDD
```
Replace `YYYYMMDD` with the current date.

---

### Layout 13: Definitions
**Visual:** Dark background. "IMPORTANT DEFINITIONS USED IN THIS REPORT" header. Definition paragraphs in Quicksand white.

**pptxgenjs approach:**
- Background: `#212121`
- Header: Rajdhani Bold, 22pt, `#FEC00F`, ALL CAPS
- Each definition: Term in Rajdhani Bold white, definition in Quicksand white, separated by blank line

Default definitions to include when statistical terms are used:
- **S&P 500 Index:** Market-cap weighted index of 500 leading US publicly traded companies.
- **Beta:** Measures relationship between an investment and the S&P 500. Beta of 1 = moves with the market.
- **Standard Deviation:** Measures volatility; higher = more risk.
- **Maximum Drawdown:** Largest peak-to-trough decline in a period.
- **Correlation:** Statistical measure of how two investments move relative to each other (-1 to +1).
- **Sharpe Ratio:** Return per unit of risk (excess return ÷ standard deviation).

---

## 6. Asset Paths

Assets are in this skill package. Use these paths relative to the skill folder:

| Asset | Path |
|-------|------|
| Full logo (dark bg) | `brand-assets/logos/potomac-full-logo.png` |
| Icon (black) | `brand-assets/logos/potomac-icon-black.png` |
| Icon (yellow) | `brand-assets/logos/potomac-icon-yellow.png` |

In generated scripts, resolve with:
```javascript
const LOGO_PATH = path.join(__dirname, 'brand-assets/logos/potomac-full-logo.png');
```

If the logo file doesn't exist at runtime, fall back to a text "POTOMAC" label:
```javascript
function addLogo(slide, pres, x, y, w, h) {
  if (fs.existsSync(LOGO_PATH)) {
    slide.addImage({ path: LOGO_PATH, x, y, w, h });
  } else {
    slide.addText('POTOMAC', {
      x, y, w, h,
      fontFace: 'Rajdhani', fontSize: 16, bold: true,
      color: 'FEC00F', align: 'left', valign: 'middle'
    });
  }
}
```

---

## 7. Complete Generator Code

**API Mode:** Embed ALL of this code verbatim in the returned Node.js script. Set `OUTPUT_PATH` and `LOGO_PATH` at the top. Embed the full `OUTLINE` object. Do not reference this skill file — include everything inline.

**Interactive Mode (claude.ai):** Run directly with `node generate.js`.

```javascript
#!/usr/bin/env node
// JSPPTXPotomac — Potomac Presentation Generator
// Requires: npm install pptxgenjs
// Run: node generate.js

'use strict';

const pptxgen = require('pptxgenjs');
const fs = require('fs');
const path = require('path');

// ── CONFIGURE THESE ───────────────────────────────────────────────────────────
const OUTPUT_PATH = process.env.POTOMAC_OUTPUT || 'Potomac_Presentation.pptx';
const LOGO_PATH   = process.env.POTOMAC_LOGO   || path.join(__dirname, 'brand-assets/logos/potomac-full-logo.png');
// ─────────────────────────────────────────────────────────────────────────────

// ── BRAND CONSTANTS ───────────────────────────────────────────────────────────
const C = {
  YELLOW:    'FEC00F',
  DARK:      '212121',
  WHITE:     'FFFFFF',
  TURQUOISE: '00DED1',
  GRAY_60:   '737373',
  GRAY_20:   'C6C6C6',
  GRAY_ALT:  'F5F5F5',
};

const F = {
  HEAD: 'Rajdhani',
  BODY: 'Quicksand',
};

// ── SLIDE DIMENSIONS (pptxgenjs LAYOUT_WIDE = 13.33 x 7.5 inches) ────────────
const W = 13.33;
const H = 7.5;

// ── UTILITIES ─────────────────────────────────────────────────────────────────

function addLogo(slide, pres, x = 0.4, y = 0.2, w = 1.8, h = 0.55) {
  if (fs.existsSync(LOGO_PATH)) {
    slide.addImage({ path: LOGO_PATH, x, y, w, h });
  } else {
    slide.addText('POTOMAC', {
      x, y, w, h,
      fontFace: F.HEAD, fontSize: 18, bold: true,
      color: C.YELLOW, align: 'left', valign: 'middle'
    });
  }
}

function addSectionTag(slide, tag, strategyName) {
  if (!tag && !strategyName) return;
  const text = strategyName ? `${strategyName} | ${tag || ''}` : tag;
  slide.addText(text.toUpperCase(), {
    x: 0.4, y: 0.15, w: 6, h: 0.35,
    fontFace: F.HEAD, fontSize: 11, bold: true,
    color: C.YELLOW, align: 'left', valign: 'middle'
  });
}

function addYellowRule(slide, x, y, w = 2, h = 0.06) {
  slide.addShape(pptxgen.shapes ? pptxgen.shapes.RECTANGLE : 'rect', {
    x, y, w, h, fill: { color: C.YELLOW }, line: { color: C.YELLOW }
  });
}

function addIconBadge(slide) {
  // Yellow circle badge top-right
  slide.addShape('ellipse', {
    x: W - 1.1, y: 0.15, w: 0.75, h: 0.75,
    fill: { color: C.YELLOW }, line: { color: C.YELLOW }
  });
}

// ── SLIDE BUILDERS ────────────────────────────────────────────────────────────

function buildCover(pres, data) {
  const slide = pres.addSlide();
  slide.background = { color: C.YELLOW };

  addLogo(slide, pres, 0.4, 0.25, 2.0, 0.65);

  const title = (data.title || 'POTOMAC PRESENTATION').toUpperCase();
  slide.addText(title, {
    x: 1.0, y: 2.5, w: W - 2, h: 2.5,
    fontFace: F.HEAD, fontSize: 52, bold: true,
    color: C.DARK, align: 'center', valign: 'middle'
  });

  slide.addText('Built to Conquer Risk®', {
    x: 0.4, y: H - 0.75, w: W - 0.8, h: 0.5,
    fontFace: F.BODY, fontSize: 14,
    color: C.DARK, align: 'center', valign: 'middle', italic: true
  });
}

function buildSectionDivider(pres, data) {
  const slide = pres.addSlide();
  slide.background = { color: C.WHITE };

  addIconBadge(slide);

  const title = (data.section_title || data.title || 'SECTION').toUpperCase();
  slide.addText(title, {
    x: 0.8, y: 2.5, w: W - 1.6, h: 2.0,
    fontFace: F.HEAD, fontSize: 44, bold: true,
    color: C.DARK, align: 'center', valign: 'middle'
  });

  // Yellow rule centered below title
  slide.addShape('rect', {
    x: (W - 3) / 2, y: 4.65, w: 3, h: 0.08,
    fill: { color: C.YELLOW }, line: { color: C.YELLOW }
  });
}

function buildFiveComponentDiagram(pres, data) {
  const slide = pres.addSlide();
  slide.background = { color: C.DARK };

  addSectionTag(slide, data.section_tag, data.subtitle);
  addIconBadge(slide);

  slide.addText((data.title || '').toUpperCase(), {
    x: 0.4, y: 0.55, w: W - 1.5, h: 0.7,
    fontFace: F.HEAD, fontSize: 26, bold: true, color: C.WHITE
  });

  // Corner positions: [x, y]
  const corners = {
    top_left:     [0.4,       1.5],
    top_right:    [W - 4.5,  1.5],
    bottom_left:  [0.4,       4.5],
    bottom_right: [W - 4.5,  4.5],
  };

  const components = data.components || [];
  components.forEach(comp => {
    const pos = corners[comp.position];
    if (!pos) return;
    const [cx, cy] = pos;
    slide.addText((comp.label || '').toUpperCase(), {
      x: cx, y: cy, w: 3.8, h: 0.4,
      fontFace: F.HEAD, fontSize: 14, bold: true, color: C.YELLOW
    });
    slide.addText(comp.body || '', {
      x: cx, y: cy + 0.4, w: 3.8, h: 1.0,
      fontFace: F.BODY, fontSize: 12, color: C.WHITE, wrap: true
    });
  });

  // Center box
  const cx = (W - 3.2) / 2;
  const cy = 2.7;
  slide.addShape('rect', {
    x: cx, y: cy, w: 3.2, h: 2.2,
    fill: { color: C.DARK }, line: { color: C.YELLOW, w: 2 }
  });
  slide.addText((data.center_label || '').toUpperCase(), {
    x: cx, y: cy + 0.2, w: 3.2, h: 0.5,
    fontFace: F.HEAD, fontSize: 14, bold: true, color: C.YELLOW, align: 'center'
  });
  slide.addText(data.center_body || '', {
    x: cx, y: cy + 0.75, w: 3.2, h: 1.2,
    fontFace: F.BODY, fontSize: 12, color: C.WHITE, align: 'center', wrap: true
  });
}

function buildThreePillars(pres, data) {
  const slide = pres.addSlide();
  slide.background = { color: C.DARK };

  addSectionTag(slide, data.section_tag);
  addIconBadge(slide);

  slide.addText((data.title || '').toUpperCase(), {
    x: 0.4, y: 0.55, w: W - 1.5, h: 0.8,
    fontFace: F.HEAD, fontSize: 28, bold: true, color: C.WHITE
  });

  if (data.subtitle) {
    slide.addText(data.subtitle, {
      x: 0.4, y: 1.45, w: W - 1.5, h: 0.5,
      fontFace: F.BODY, fontSize: 14, color: C.GRAY_60
    });
  }

  const pillars = data.pillars || [];
  const colW = (W - 1.2) / 3;
  pillars.forEach((pillar, i) => {
    const x = 0.4 + i * colW + i * 0.2;
    const num = String(i + 1);
    // Circle
    slide.addShape('ellipse', {
      x: x + (colW - 1.0) / 2, y: 2.2, w: 1.0, h: 1.0,
      fill: { color: C.YELLOW }, line: { color: C.YELLOW }
    });
    slide.addText(num, {
      x: x + (colW - 1.0) / 2, y: 2.2, w: 1.0, h: 1.0,
      fontFace: F.HEAD, fontSize: 32, bold: true,
      color: C.DARK, align: 'center', valign: 'middle'
    });
    // Label
    slide.addText((pillar.label || '').toUpperCase(), {
      x, y: 3.4, w: colW, h: 0.5,
      fontFace: F.HEAD, fontSize: 16, bold: true,
      color: C.YELLOW, align: 'center'
    });
    // Description
    slide.addText(pillar.description || '', {
      x, y: 3.95, w: colW, h: 2.5,
      fontFace: F.BODY, fontSize: 13, color: C.WHITE,
      align: 'center', wrap: true
    });
  });
}

function buildChart(pres, data) {
  const slide = pres.addSlide();
  slide.background = { color: C.WHITE };

  addSectionTag(slide, data.section_tag);
  addIconBadge(slide);

  slide.addText((data.chart_title || 'CHART TITLE').toUpperCase(), {
    x: 0.4, y: 0.55, w: W - 1.5, h: 0.7,
    fontFace: F.HEAD, fontSize: 28, bold: true, color: C.DARK
  });

  addYellowRule(slide, 0.4, 1.3);

  // Chart image or placeholder
  const chartPath = data.chart_image_path;
  if (chartPath && fs.existsSync(chartPath)) {
    slide.addImage({ path: chartPath, x: 0.4, y: 1.5, w: W - 0.8, h: 5.2 });
  } else {
    slide.addShape('rect', {
      x: 0.4, y: 1.5, w: W - 0.8, h: 5.2,
      fill: { color: C.GRAY_20 }, line: { color: C.GRAY_60 }
    });
    slide.addText('[ CHART ]', {
      x: 0.4, y: 1.5, w: W - 0.8, h: 5.2,
      fontFace: F.HEAD, fontSize: 24, color: C.GRAY_60, align: 'center', valign: 'middle'
    });
  }

  if (data.chart_caption) {
    slide.addText(data.chart_caption, {
      x: 0.4, y: H - 0.45, w: W - 0.8, h: 0.35,
      fontFace: F.BODY, fontSize: 9, color: C.GRAY_60, italic: true
    });
  }
}

function buildCompositeThree(pres, data) {
  const slide = pres.addSlide();
  slide.background = { color: C.DARK };

  addSectionTag(slide, data.section_tag);
  addIconBadge(slide);

  slide.addText((data.headline || '').toUpperCase(), {
    x: 0.4, y: 0.55, w: W - 1.5, h: 0.9,
    fontFace: F.HEAD, fontSize: 22, bold: true, color: C.WHITE, wrap: true
  });

  const components = data.components || [];
  const boxW = (W - 1.4) / 3;
  const boxY = 1.7;
  const boxH = H - boxY - 0.4;

  components.forEach((comp, i) => {
    const x = 0.4 + i * (boxW + 0.1);
    const isResult = comp.is_result;
    const fillColor = isResult ? C.YELLOW : C.DARK;
    const borderColor = C.YELLOW;
    const titleColor = isResult ? C.DARK : C.YELLOW;
    const bodyColor = isResult ? C.DARK : C.WHITE;

    slide.addShape('rect', {
      x, y: boxY, w: boxW, h: boxH,
      fill: { color: fillColor }, line: { color: borderColor, w: 2 }
    });

    // + connector between boxes
    if (i < components.length - 1) {
      const sym = i === components.length - 2 ? '=' : '+';
      slide.addText(sym, {
        x: x + boxW, y: boxY + boxH / 2 - 0.3, w: 0.1, h: 0.6,
        fontFace: F.HEAD, fontSize: 24, bold: true, color: C.YELLOW, align: 'center'
      });
    }

    slide.addText((comp.title || '').toUpperCase(), {
      x: x + 0.15, y: boxY + 0.2, w: boxW - 0.3, h: 0.55,
      fontFace: F.HEAD, fontSize: 15, bold: true, color: titleColor, align: 'center'
    });
    slide.addText(comp.body || '', {
      x: x + 0.15, y: boxY + 0.85, w: boxW - 0.3, h: boxH - 1.1,
      fontFace: F.BODY, fontSize: 13, color: bodyColor, align: 'center', wrap: true
    });
  });
}

function buildCompositeFour(pres, data) {
  const slide = pres.addSlide();
  slide.background = { color: C.DARK };

  addSectionTag(slide, data.section_tag);
  addIconBadge(slide);

  slide.addText((data.title || '').toUpperCase(), {
    x: 0.4, y: 0.55, w: W - 1.5, h: 0.65,
    fontFace: F.HEAD, fontSize: 26, bold: true, color: C.WHITE
  });
  if (data.subtitle) {
    slide.addText(data.subtitle, {
      x: 0.4, y: 1.25, w: W - 1.5, h: 0.45,
      fontFace: F.BODY, fontSize: 14, color: C.GRAY_60
    });
  }

  const components = data.components || [];
  const inputs = components.filter(c => !c.is_result);
  const result = components.find(c => c.is_result);
  const inputH = 1.4;
  const inputW = 5.0;
  const startY = 1.85;
  const gap = 0.2;

  inputs.forEach((comp, i) => {
    const y = startY + i * (inputH + gap);
    slide.addShape('rect', {
      x: 0.4, y, w: inputW, h: inputH,
      fill: { color: C.DARK }, line: { color: C.YELLOW, w: 2 }
    });
    slide.addText((comp.title || '').toUpperCase(), {
      x: 0.6, y: y + 0.1, w: inputW - 0.4, h: 0.4,
      fontFace: F.HEAD, fontSize: 14, bold: true, color: C.YELLOW
    });
    slide.addText(comp.body || '', {
      x: 0.6, y: y + 0.55, w: inputW - 0.4, h: inputH - 0.65,
      fontFace: F.BODY, fontSize: 12, color: C.WHITE, wrap: true
    });
  });

  // Arrow
  slide.addText('→', {
    x: inputW + 0.4, y: startY + (inputs.length * (inputH + gap)) / 2 - 0.4, w: 0.8, h: 0.8,
    fontFace: F.HEAD, fontSize: 36, color: C.YELLOW, align: 'center', valign: 'middle'
  });

  // Result box
  if (result) {
    const resX = inputW + 1.4;
    const resW = W - resX - 0.4;
    const resH = inputs.length * (inputH + gap) - gap;
    slide.addShape('rect', {
      x: resX, y: startY, w: resW, h: resH,
      fill: { color: C.YELLOW }, line: { color: C.YELLOW }
    });
    slide.addText((result.title || '').toUpperCase(), {
      x: resX + 0.2, y: startY + 0.2, w: resW - 0.4, h: 0.55,
      fontFace: F.HEAD, fontSize: 15, bold: true, color: C.DARK, align: 'center'
    });
    slide.addText(result.body || '', {
      x: resX + 0.2, y: startY + 0.85, w: resW - 0.4, h: resH - 1.1,
      fontFace: F.BODY, fontSize: 13, color: C.DARK, align: 'center', wrap: true
    });
  }

  if (data.footnote) {
    slide.addText(data.footnote, {
      x: 0.4, y: H - 0.4, w: W - 0.8, h: 0.3,
      fontFace: F.BODY, fontSize: 9, color: C.GRAY_60, italic: true
    });
  }
}

function buildStrategyTable(pres, data) {
  const slide = pres.addSlide();
  slide.background = { color: C.WHITE };

  addSectionTag(slide, null, data.strategy_name);
  addIconBadge(slide);

  slide.addText((data.title || '').toUpperCase(), {
    x: 0.4, y: 0.55, w: W - 1.5, h: 0.7,
    fontFace: F.HEAD, fontSize: 28, bold: true, color: C.DARK
  });
  addYellowRule(slide, 0.4, 1.3);

  const columns = data.columns || ['COLUMN 1', 'COLUMN 2'];
  const rows = data.rows || [];
  const colCount = columns.length;
  const colW = (W - 0.8) / colCount;

  const tableRows = [];

  // Title row (merged look — single cell spanning all cols)
  const titleRow = [{
    text: (data.table_title || '').toUpperCase(),
    options: {
      fontFace: F.HEAD, fontSize: 14, bold: true, color: C.DARK,
      fill: C.YELLOW, align: 'center', colspan: colCount
    }
  }];
  tableRows.push(titleRow);

  // Header row
  const headerRow = columns.map(col => ({
    text: col.toUpperCase(),
    options: { fontFace: F.HEAD, fontSize: 12, bold: true, color: C.WHITE, fill: C.DARK, align: 'center' }
  }));
  tableRows.push(headerRow);

  // Data rows
  rows.forEach((row, i) => {
    const fillColor = i % 2 === 0 ? C.WHITE : C.GRAY_ALT;
    const cells = (Array.isArray(row) ? row : [row]).map(cell => ({
      text: String(cell),
      options: { fontFace: F.BODY, fontSize: 12, color: C.DARK, fill: fillColor }
    }));
    tableRows.push(cells);
  });

  slide.addTable(tableRows, {
    x: 0.4, y: 1.5, w: W - 0.8,
    rowH: 0.45,
    border: { type: 'solid', color: C.GRAY_20, pt: 1 }
  });

  if (data.footnote) {
    slide.addText(data.footnote, {
      x: 0.4, y: H - 0.45, w: W - 0.8, h: 0.35,
      fontFace: F.BODY, fontSize: 9, color: C.GRAY_60, italic: true
    });
  }
}

function buildRiskStatistics(pres, data) {
  const slide = pres.addSlide();
  slide.background = { color: C.WHITE };

  addSectionTag(slide, null, data.strategy_name);
  addIconBadge(slide);

  slide.addText((data.headline || '').toUpperCase(), {
    x: 0.4, y: 0.55, w: W - 1.5, h: 0.7,
    fontFace: F.HEAD, fontSize: 26, bold: true, color: C.DARK
  });
  addYellowRule(slide, 0.4, 1.3);

  const columns = data.columns || ['NET'];
  const rows = data.rows || [];
  const tableTitle = data.table_title || 'RISK STATISTICS';

  const colHeaders = ['', ...columns];
  const colW = (W - 0.8) / colHeaders.length;

  const tableRows = [];

  // Title row
  tableRows.push([{
    text: tableTitle.toUpperCase(),
    options: {
      fontFace: F.HEAD, fontSize: 14, bold: true, color: C.DARK,
      fill: C.YELLOW, align: 'center', colspan: colHeaders.length
    }
  }]);

  // Header row
  tableRows.push(colHeaders.map(h => ({
    text: h.toUpperCase(),
    options: { fontFace: F.HEAD, fontSize: 12, bold: true, color: C.WHITE, fill: C.DARK, align: 'center' }
  })));

  // Data rows
  rows.forEach((row, i) => {
    const fillColor = i % 2 === 0 ? C.WHITE : C.GRAY_ALT;
    const cells = [
      { text: row.label || '', options: { fontFace: F.BODY, fontSize: 12, color: C.DARK, fill: fillColor } },
      ...(row.values || []).map(v => ({
        text: String(v),
        options: { fontFace: F.HEAD, fontSize: 13, bold: true, color: C.DARK, fill: fillColor, align: 'center' }
      }))
    ];
    tableRows.push(cells);
  });

  slide.addTable(tableRows, {
    x: 0.4, y: 1.5, w: W - 0.8,
    rowH: 0.45,
    border: { type: 'solid', color: C.GRAY_20, pt: 1 }
  });

  if (data.disclaimer) {
    slide.addText(data.disclaimer, {
      x: 0.4, y: H - 0.55, w: W - 0.8, h: 0.45,
      fontFace: F.BODY, fontSize: 9, color: C.GRAY_60, italic: true, wrap: true
    });
  }
}

function buildUseCases(pres, data) {
  const slide = pres.addSlide();
  slide.background = { color: C.DARK };

  addSectionTag(slide, null, data.strategy_name);
  addIconBadge(slide);

  slide.addText((data.title || '').toUpperCase(), {
    x: 0.4, y: 0.55, w: W - 1.5, h: 0.7,
    fontFace: F.HEAD, fontSize: 28, bold: true, color: C.WHITE
  });

  const cases = (data.cases || []).slice(0, 4);
  const circleD = 2.8;
  const gap = (W - 0.8 - cases.length * circleD) / (cases.length - 1 || 1);

  cases.forEach((c, i) => {
    const x = 0.4 + i * (circleD + gap);
    const y = 1.7;
    slide.addShape('ellipse', {
      x, y, w: circleD, h: circleD,
      fill: { color: C.DARK }, line: { color: C.YELLOW, w: 3 }
    });
    slide.addText((c.title || '').toUpperCase(), {
      x: x + 0.1, y: y + 0.4, w: circleD - 0.2, h: 0.55,
      fontFace: F.HEAD, fontSize: 13, bold: true, color: C.YELLOW, align: 'center'
    });
    slide.addText(c.body || '', {
      x: x + 0.1, y: y + 1.0, w: circleD - 0.2, h: 1.4,
      fontFace: F.BODY, fontSize: 11, color: C.WHITE, align: 'center', wrap: true
    });
  });
}

function buildThankYou(pres, data) {
  const slide = pres.addSlide();
  slide.background = { color: C.DARK };

  addLogo(slide, pres, 0.4, 0.25, 2.0, 0.65);

  slide.addText('THANK YOU!', {
    x: 0.4, y: 2.5, w: W - 0.8, h: 1.5,
    fontFace: F.HEAD, fontSize: 60, bold: true,
    color: C.WHITE, align: 'center', valign: 'middle'
  });

  slide.addText('We have a team of regional consultants ready to help.', {
    x: 0.4, y: 4.2, w: W - 0.8, h: 0.6,
    fontFace: F.BODY, fontSize: 16,
    color: C.YELLOW, align: 'center', italic: true
  });

  slide.addText('potomac.com', {
    x: 0.4, y: 5.2, w: W - 0.8, h: 0.4,
    fontFace: F.BODY, fontSize: 14, color: C.WHITE, align: 'center'
  });
}

function buildDisclosures(pres, data) {
  const today = new Date();
  const dateStr = today.toISOString().slice(0, 10).replace(/-/g, '');
  const complianceId = `PFM-508-${dateStr}`;

  const disclosureText =
    'Potomac is a registered investment adviser. Registration with the SEC does not imply a certain level of skill or training. ' +
    'The information presented herein is for informational and educational purposes only and is not intended as investment advice. ' +
    'Past performance does not guarantee future results. All investing involves risk, including possible loss of principal. ' +
    'The strategies described may not be suitable for all investors.\n\n' +
    'Indices referenced are unmanaged and cannot be invested in directly. The S&P 500 Index is a market-capitalization-weighted ' +
    'index of 500 leading publicly traded companies in the U.S.\n\n' +
    'Please refer to Potomac\'s Form ADV Part 2A for additional information about our services, fees, and risks. ' +
    'A copy is available at www.adviserinfo.sec.gov or by contacting us at info@potomac.com.\n\n' +
    complianceId;

  const slide = pres.addSlide();
  slide.background = { color: C.DARK };

  addIconBadge(slide);

  slide.addText('DISCLOSURES', {
    x: 0.4, y: 0.25, w: W - 1.5, h: 0.55,
    fontFace: F.HEAD, fontSize: 22, bold: true, color: C.YELLOW
  });

  slide.addText(disclosureText, {
    x: 0.4, y: 0.9, w: W - 0.8, h: H - 1.1,
    fontFace: F.BODY, fontSize: 9.5, color: C.WHITE, wrap: true, lineSpacingMultiple: 1.1
  });
}

function buildDefinitions(pres, data) {
  const defs = data.definitions && data.definitions.length > 0
    ? data.definitions
    : [
        { term: 'S&P 500 Index', definition: 'A market-capitalization-weighted index of 500 leading publicly traded companies in the U.S.' },
        { term: 'Beta', definition: 'Measures the relationship between an investment and the S&P 500. A beta of 1.0 means the investment moves in line with the market.' },
        { term: 'Standard Deviation', definition: 'A measure of investment volatility. Higher standard deviation indicates higher risk.' },
        { term: 'Maximum Drawdown', definition: 'A losing period defined as the percent retrenchment from a portfolio\'s peak value to its trough value.' },
        { term: 'Correlation', definition: 'A statistical measure of how two investments move relative to one another, ranging from -1 (perfectly inverse) to +1 (perfectly correlated).' },
        { term: 'Sharpe Ratio', definition: 'A measure of risk-adjusted return. Calculated as the portfolio\'s excess return divided by its standard deviation.' },
      ];

  const defText = defs.map(d => `${d.term}: ${d.definition}`).join('\n\n');

  const slide = pres.addSlide();
  slide.background = { color: C.DARK };

  addIconBadge(slide);

  slide.addText('IMPORTANT DEFINITIONS USED IN THIS REPORT', {
    x: 0.4, y: 0.25, w: W - 1.5, h: 0.55,
    fontFace: F.HEAD, fontSize: 18, bold: true, color: C.YELLOW
  });

  slide.addText(defText, {
    x: 0.4, y: 0.95, w: W - 0.8, h: H - 1.1,
    fontFace: F.BODY, fontSize: 11, color: C.WHITE, wrap: true, lineSpacingMultiple: 1.3
  });
}

// ── LAYOUT MAP ────────────────────────────────────────────────────────────────

const BUILDERS = {
  cover:                buildCover,
  section_divider:      buildSectionDivider,
  five_component_diagram: buildFiveComponentDiagram,
  three_pillars:        buildThreePillars,
  chart:                buildChart,
  composite_three:      buildCompositeThree,
  composite_four:       buildCompositeFour,
  strategy_table:       buildStrategyTable,
  risk_statistics:      buildRiskStatistics,
  use_cases:            buildUseCases,
  thank_you:            buildThankYou,
  disclosures:          buildDisclosures,
  definitions:          buildDefinitions,
};

// ── MAIN GENERATOR ────────────────────────────────────────────────────────────

async function generate(outline) {
  const pres = new pptxgen();
  pres.layout = 'LAYOUT_WIDE';  // 13.33 x 7.5 inches, 16:9
  pres.author  = 'Potomac';
  pres.company = 'Potomac';
  pres.title   = outline.title || 'Potomac Presentation';

  const slides = outline.slides || [];
  for (const slideData of slides) {
    const builder = BUILDERS[slideData.layout];
    if (builder) {
      builder(pres, slideData);
    } else {
      console.error(`Unknown layout: ${slideData.layout} — skipping`);
    }
  }

  await pres.writeFile({ fileName: OUTPUT_PATH });

  const buf = fs.readFileSync(OUTPUT_PATH);
  const b64 = buf.toString('base64');
  const filename = path.basename(OUTPUT_PATH);

  return { pptx_base64: b64, slide_count: slides.length, filename };
}

// ── OUTLINE (embed here in API mode) ─────────────────────────────────────────

const OUTLINE = {
  "title": "EXAMPLE PRESENTATION",
  "slides": [
    { "layout": "cover", "title": "GUARDIAN: BUILT TO CONQUER RISK" },
    { "layout": "section_divider", "section_title": "OUR PROCESS" },
    {
      "layout": "three_pillars",
      "title": "MARKET ANALYSIS: THREE LEGS TO THE STOOL",
      "subtitle": "We use three factors to determine risk positioning",
      "pillars": [
        { "label": "TREND", "description": "Price trend analysis across all major asset classes" },
        { "label": "MOMENTUM", "description": "Rate of change across multiple timeframes" },
        { "label": "BREADTH", "description": "Market participation across segments" }
      ]
    },
    { "layout": "thank_you" },
    { "layout": "disclosures" },
    { "layout": "definitions" }
  ]
};

// ── ENTRY POINT ───────────────────────────────────────────────────────────────

async function main() {
  // In API mode: OUTLINE is embedded above
  // In interactive mode: optionally pipe JSON via stdin
  let outline = OUTLINE;
  if (!process.stdin.isTTY) {
    const raw = fs.readFileSync('/dev/stdin', 'utf8');
    try { outline = JSON.parse(raw); } catch {}
  }

  try {
    const result = await generate(outline);
    process.stdout.write(JSON.stringify(result) + '\n');
  } catch (err) {
    process.stderr.write(`Error: ${err.message}\n`);
    process.exit(1);
  }
}

main();
```

---

## 8. QA Requirements

### Required Checks

**1. No placeholder text remains**
```bash
# Open the PPTX and search for: INSERT, SAMPLE, [, XXX
```

**2. Brand compliance**
- [ ] All text on dark backgrounds is WHITE or YELLOW
- [ ] All text on light/yellow backgrounds is `#212121`
- [ ] All headers/titles are ALL CAPS, Rajdhani Bold
- [ ] Body text is Quicksand
- [ ] Disclosures slide included
- [ ] Definitions slide included when statistical terms used
- [ ] PFM compliance ID updated with today's date

**3. Visual review**
Open in PowerPoint or Google Slides and check each slide for layout, font rendering, and color accuracy.

### Common Issues

| Issue | Fix |
|-------|-----|
| Fonts not rendering | Rajdhani and Quicksand must be installed on the viewing machine or embedded |
| Logo not showing | Check LOGO_PATH resolves correctly; use text fallback if not found |
| Table alignment off | Adjust `colW` calculation or `w` on `addTable` |
| Shapes missing | Ensure pptxgenjs v3.x+ is installed (`npm install pptxgenjs`) |
